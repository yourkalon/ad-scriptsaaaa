<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶ì‡ßü‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-analytics-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

    <style>
        .analytics-badge {
            position: fixed;
            bottom: 10px;
            right: 10px;
            background: #2c3e50;
            color: white;
            padding: 10px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-family: Arial, sans-serif;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            z-index: 1000;
        }
        .analytics-badge span {
            margin: 0 5px;
            font-weight: bold;
        }
    </style>

    <script>
        // Firebase Configuration - ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ API Key ‡¶∏‡¶π
        const firebaseConfig = {
            apiKey: "AIzaSyCediRkFLFfRhnQWG9sCAEek_6-BMcNXXY",
            authDomain: "my-website-counter56.firebaseapp.com",
            databaseURL: "https://my-website-counter56-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "my-website-counter56",
            storageBucket: "my-website-counter56.appspot.com",
            messagingSenderId: "538008405213",
            appId: "1:538008405213:web:eed758b2a5d8466f944734",
            measurementId: "G-WXMHRXJ7SZ"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const analytics = firebase.analytics();
        const db = firebase.firestore();
        const rtdb = firebase.database();

        // Comprehensive Analytics System
        class WebsiteAnalytics {
            constructor() {
                this.sessionId = this.generateSessionId();
                this.pageStartTime = Date.now();
                this.isNewVisitor = !localStorage.getItem('returningVisitor');
                this.userId = this.getUserId();
                this.maxScroll = 0;
                
                this.init();
            }

            // ‡¶á‡¶â‡¶®‡¶ø‡¶ï ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡ßá‡¶ü
            getUserId() {
                let userId = localStorage.getItem('userId');
                if (!userId) {
                    userId = 'user_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                    localStorage.setItem('userId', userId);
                }
                return userId;
            }

            // ‡¶∏‡ßá‡¶∂‡¶® ‡¶Ü‡¶á‡¶°‡¶ø ‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡ßá‡¶ü
            generateSessionId() {
                return 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            }

            // ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶è‡¶¨‡¶Ç ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞ ‡¶á‡¶®‡¶´‡ßã
            getUserDeviceInfo() {
                return {
                    userAgent: navigator.userAgent,
                    platform: navigator.platform,
                    language: navigator.language,
                    screenWidth: screen.width,
                    screenHeight: screen.height,
                    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                    cookieEnabled: navigator.cookieEnabled
                };
            }

            // ‡¶™‡ßá‡¶ú ‡¶á‡¶®‡¶´‡ßã
            getPageInfo() {
                return {
                    url: window.location.href,
                    path: window.location.pathname,
                    hostname: window.location.hostname,
                    referrer: document.referrer,
                    title: document.title,
                    timestamp: new Date().toISOString()
                };
            }

            // ‡¶∞‡¶ø‡ßü‡ßá‡¶≤-‡¶ü‡¶æ‡¶á‡¶Æ ‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶∏‡ßá ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü‡¶∞ ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü
            async updateRealtimeCounter() {
                try {
                    const counterRef = rtdb.ref('visitor_count');
                    
                    // ‡¶ü‡ßã‡¶ü‡¶æ‡¶≤ ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü‡¶∞ ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü
                    await counterRef.transaction((current) => {
                        return (current || 0) + 1;
                    });

                    // ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶ü‡¶ø‡¶≠ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞
                    const activeRef = rtdb.ref('active_users/' + this.sessionId);
                    await activeRef.set({
                        userId: this.userId,
                        lastActive: new Date().toISOString(),
                        userAgent: navigator.userAgent.substring(0, 100)
                    });

                    // ‡¶™‡ßá‡¶ú ‡¶Ü‡¶®‡¶≤‡ßã‡¶° ‡¶π‡¶≤‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶ü‡¶ø‡¶≠ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶∞‡¶ø‡¶Æ‡ßÅ‡¶≠
                    window.addEventListener('beforeunload', () => {
                        activeRef.remove();
                    });

                } catch (error) {
                    console.error('Realtime DB error:', error);
                }
            }

            // ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü‡¶∞ ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï
            async trackVisit() {
                const deviceInfo = this.getUserDeviceInfo();
                const pageInfo = this.getPageInfo();
                
                const visitData = {
                    sessionId: this.sessionId,
                    userId: this.userId,
                    isNewVisitor: this.isNewVisitor,
                    deviceInfo: deviceInfo,
                    pageInfo: pageInfo,
                    visitTime: new Date().toISOString(),
                    type: 'page_visit'
                };

                try {
                    // Firestore-‡¶è ‡¶°‡ßá‡¶ü‡¶æ ‡¶∏‡ßá‡¶≠
                    await db.collection('website_analytics').add(visitData);
                    
                    // Firebase Analytics-‡¶è ‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü ‡¶∏‡ßá‡¶®‡ßç‡¶°
                    analytics.logEvent('page_view', {
                        page_title: pageInfo.title,
                        page_location: pageInfo.url,
                        user_id: this.userId
                    });

                    console.log('Visit tracked successfully');
                } catch (error) {
                    console.error('Error tracking visit:', error);
                }
            }

            // ‡¶∏‡ßá‡¶∂‡¶® ‡¶°‡ßÅ‡¶∞‡ßá‡¶∂‡¶® ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï
            async trackSessionDuration() {
                window.addEventListener('beforeunload', async () => {
                    const sessionDuration = Date.now() - this.pageStartTime;
                    
                    const sessionData = {
                        sessionId: this.sessionId,
                        userId: this.userId,
                        duration: sessionDuration,
                        endTime: new Date().toISOString(),
                        maxScroll: this.maxScroll,
                        type: 'session_end'
                    };

                    try {
                        await db.collection('website_analytics').add(sessionData);
                    } catch (error) {
                        console.error('Error tracking session:', error);
                    }
                });
            }

            // ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï
            trackClicks() {
                document.addEventListener('click', (e) => {
                    const clickData = {
                        sessionId: this.sessionId,
                        userId: this.userId,
                        element: e.target.tagName,
                        id: e.target.id || 'no-id',
                        className: e.target.className || 'no-class',
                        text: e.target.textContent?.substring(0, 50) || 'no-text',
                        timestamp: new Date().toISOString(),
                        type: 'click'
                    };

                    // ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®
                    if (e.target.id || e.target.className.includes('btn') || 
                        e.target.tagName === 'BUTTON' || e.target.tagName === 'A') {
                        db.collection('website_analytics').add(clickData);
                    }
                });
            }

            // ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡ßã‡¶≤ ‡¶¨‡¶ø‡¶π‡ßá‡¶≠‡¶ø‡ßü‡¶æ‡¶∞ ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï
            trackScroll() {
                window.addEventListener('scroll', () => {
                    const currentScroll = (window.scrollY / (document.documentElement.scrollHeight - window.innerHeight)) * 100;
                    this.maxScroll = Math.max(this.maxScroll, currentScroll);
                });
            }

            // ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
            trackCustomEvent(eventName, eventData = {}) {
                const customEvent = {
                    sessionId: this.sessionId,
                    userId: this.userId,
                    eventName: eventName,
                    eventData: eventData,
                    timestamp: new Date().toISOString(),
                    type: 'custom_event'
                };

                db.collection('website_analytics').add(customEvent);
                analytics.logEvent(eventName, eventData);
            }

            // ‡¶∏‡¶¨ ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡ßü‡¶æ‡¶≤‡¶æ‡¶á‡¶ú
            async init() {
                await this.trackVisit();
                await this.updateRealtimeCounter();
                this.trackSessionDuration();
                this.trackClicks();
                this.trackScroll();
                
                // ‡¶∞‡¶ø‡¶ü‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü‡¶∞ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®
                if (this.isNewVisitor) {
                    localStorage.setItem('returningVisitor', 'true');
                }

                console.log('Analytics initialized for user:', this.userId);
            }
        }

        // Analytics ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®
        document.addEventListener('DOMContentLoaded', function() {
            window.websiteAnalytics = new WebsiteAnalytics();
            
            // ‡¶∞‡¶ø‡ßü‡ßá‡¶≤-‡¶ü‡¶æ‡¶á‡¶Æ ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶æ‡¶∞ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®
            setupRealTimeCounter();
        });

        // ‡¶∞‡¶ø‡ßü‡ßá‡¶≤-‡¶ü‡¶æ‡¶á‡¶Æ ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∏‡ßá‡¶ü‡¶Ü‡¶™
        function setupRealTimeCounter() {
            const counterRef = rtdb.ref('visitor_count');
            const activeUsersRef = rtdb.ref('active_users');
            
            // ‡¶ü‡ßã‡¶ü‡¶æ‡¶≤ ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü‡¶∞ ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü
            counterRef.on('value', (snapshot) => {
                const totalVisitors = snapshot.val() || 0;
                document.getElementById('totalVisitors').textContent = totalVisitors;
            });
            
            // ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶ü‡¶ø‡¶≠ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü
            activeUsersRef.on('value', (snapshot) => {
                const activeUsers = snapshot.numChildren();
                document.getElementById('activeUsers').textContent = activeUsers;
            });
        }

        // ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ó‡ßç‡¶≤‡ßã‡¶¨‡¶æ‡¶≤ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        function trackEvent(eventName, eventData) {
            if (window.websiteAnalytics) {
                window.websiteAnalytics.trackCustomEvent(eventName, eventData);
            }
        }
    </script>
</head>
<body>
    <!-- ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ì‡ßü‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü -->
    <header>
        <h1>‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶ì‡ßü‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü‡ßá ‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ</h1>
        <nav>
            <a href="/">‡¶π‡ßã‡¶Æ</a>
            <a href="/about">‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï‡ßá</a>
            <a href="/contact">‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó</a>
        </nav>
    </header>

    <main>
        <section>
            <h2>‡¶ì‡ßü‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü</h2>
            <p>‡¶è‡¶ü‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ì‡ßü‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü‡ßá‡¶∞ ‡¶Æ‡ßÇ‡¶≤ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü‡•§</p>
            <button onclick="trackEvent('button_click', {button_name: 'sample_button'})">
                ‡¶®‡¶Æ‡ßÅ‡¶®‡¶æ ‡¶¨‡¶æ‡¶ü‡¶®
            </button>
        </section>
    </main>

    <!-- Analytics Badge -->
    <div class="analytics-badge">
        üî• Visitors: <span id="totalVisitors">0</span> | 
        üë• Active: <span id="activeUsers">0</span>
    </div>

    <!-- ‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£: ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï‡¶ø‡¶Ç -->
    <script>
        // ‡¶´‡¶∞‡ßç‡¶Æ ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶∂‡¶® ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£
        document.addEventListener('DOMContentLoaded', function() {
            // ‡¶Ø‡¶¶‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶´‡¶∞‡ßç‡¶Æ ‡¶•‡¶æ‡¶ï‡ßá
            const forms = document.querySelectorAll('form');
            forms.forEach(form => {
                form.addEventListener('submit', function(e) {
                    trackEvent('form_submit', {
                        form_id: this.id || 'unknown',
                        form_action: this.action || 'unknown'
                    });
                });
            });

            // ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï
            const links = document.querySelectorAll('a');
            links.forEach(link => {
                link.addEventListener('click', function() {
                    trackEvent('link_click', {
                        link_text: this.textContent.substring(0, 30),
                        link_url: this.href
                    });
                });
            });
        });
    </script>
</body>
</html>
